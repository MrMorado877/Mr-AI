<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Nexora AI</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  margin:0;
  font-family: Arial, sans-serif;
  background:#0b0b0b;
  color:white;
}

.top {
  display:flex;
  align-items:center;
  padding:10px;
  background:#111;
  border-bottom:1px solid #222;
}

.top img {
  width:40px;
  height:40px;
  border-radius:50%;
  margin-right:10px;
}

.logout {
  margin-left:auto;
  background:red;
  color:white;
  border:none;
  padding:8px 14px;
  cursor:pointer;
}

.chat {
  height:75vh;
  overflow-y:auto;
  padding:15px;
}

.msg {
  margin-bottom:15px;
}

.user { color:#00aaff; }
.ai { color:#00ff99; }

.input-box {
  display:flex;
  padding:10px;
  background:#111;
}

input {
  flex:1;
  padding:10px;
  border:none;
  outline:none;
  background:#222;
  color:white;
}

button {
  padding:10px 15px;
  border:none;
  background:#00ff99;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="top">
  <img id="pic">
  <div>
    <div id="name"></div>
    <small id="email"></small>
  </div>
  <button class="logout" onclick="logout()">Logout</button>
</div>

<div class="chat" id="chat"></div>

<div class="input-box">
  <input id="msg" placeholder="Ask Nexora AI...">
  <button onclick="send()">Send</button>
</div>

<script>
const API = "https://backend-b80q.onrender.com";

// üîê Check login
const email = localStorage.getItem("userEmail");
const name = localStorage.getItem("userName");
const pic = localStorage.getItem("userPic");

if (!email) {
  window.location.href = "login.html";
}

document.getElementById("name").innerText = name;
document.getElementById("email").innerText = email;
document.getElementById("pic").src = pic;

function logout() {
  localStorage.clear();
  window.location.href = "login.html";
}

function add(sender, text) {
  const div = document.createElement("div");
  div.className = "msg " + sender;
  div.innerText = (sender === "user" ? "You: " : "Nexora: ") + text;
  document.getElementById("chat").appendChild(div);
  div.scrollIntoView();
}

async function send() {
  const input = document.getElementById("msg");
  const text = input.value.trim();
  if (!text) return;

  add("user", text);
  input.value = "";

  try {
    const res = await fetch(API + "/chat", {
      method: "POST",
      headers: { "Content-Type":"application/json" },
      body: JSON.stringify({
        email: email,
        message: text
      })
    });

    const data = await res.json();
    add("ai", data.reply);

  } catch (e) {
    add("ai", "Server not reachable");
  }
}
</script>

</body>
</html>
